{{#let (guid-for @config) as |id|}}
  <div class="form__row {{if (changeset-dirty @changeset @config.key) 'form__row--dirty'}}">
    <label class="input__label" for={{id}}>
      {{or @config.label "Unlabeled"}}

      {{#if @config.locked}}
        <Icons::Lock />
      {{/if}}
    </label>

    {{#if (eq @config.control "array")}}
      <FormArray
        @form={{@form}}
        @elements={{changeset-get @changeset @config.key}}
        @changed={{queue (changeset-set @changeset @config.key) @changed}}
        @factory={{this.createElement}}
        @itemName={{@config.itemName}}
        as |formArray|
      >
        {{#each @config.itemFields as |field|}}
          <FormField
            @form={{@form}}
            @config={{field}}
            @changeset={{formArray.changeset}}
            @changed={{formArray.changed}}
          />
        {{/each}}
      </FormArray>
    {{else}}
      <Controls::Generic
        @type={{@config.control}}
        @id={{id}}
        @key={{@config.key}}
        @model={{@changeset}}
        @value={{changeset-get @changeset @config.key}}
        @changed={{queue (changeset-set @changeset @config.key) @changed}}
        @disabled={{or (evaluate @config.disabled @changeset) (and @config.locked @form.locked)}}
        @placeholder={{@config.placeholder}}
        @redacted={{@config.redacted}}
        @min={{@config.min}}
        @max={{@config.max}}
        @step={{@config.step}}
        @options={{@config.options}}
        @collection={{evaluate @config.source @changeset}}
        @multiple={{@config.multiple}}
        @labelKey={{@config.labelKey}}
        @emptyLabel={{@config.emptyLabel}}
        @allowEmpty={{@config.allowEmpty}}
        @preview={{@config.previewFile}}
        @accept={{@config.acceptMedia}}
      />
    {{/if}}

    {{#if @config.hint}}
      <div class="input__hint">
        {{@config.hint}}
      </div>
    {{/if}}
  </div>
{{/let}}